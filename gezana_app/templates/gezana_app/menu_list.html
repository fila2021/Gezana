{% extends "gezana_app/base.html" %}
{% load static %}

{% block title %}Menu – Gezana{% endblock %}

{% block content %}

<section class="menu-hero">
  <div>
    <p class="eyebrow">Habesha Flavours</p>
    <h2>Share injera, spice, and coffee aromas</h2>
    <p class="lede">
      From doro wat to tibs and vegan shiro, every plate is cooked fresh with berbere heat and served to share.
    </p>
  </div>

  <div class="menu-legend">
    <span class="pill veg">Veg</span>
    <span class="pill new">New</span>
    <span class="pill popular">Popular</span>
    <span class="pill chef">Chef's pick</span>
  </div>
</section>

<!-- CATEGORY FILTER (CARD BUTTONS) -->
<section class="menu-category-bar card">

  <div class="category-cards">

    <a href="{% url 'gezana_app:menu_list' %}"
       class="category-card {% if not category %}active{% endif %}">
      All
    </a>

    <a href="{% url 'gezana_app:menu_list' %}?category=starter"
       class="category-card {% if category == 'starter' %}active{% endif %}">
      Starter
    </a>

    <a href="{% url 'gezana_app:menu_list' %}?category=main"
       class="category-card {% if category == 'main' %}active{% endif %}">
      Main Course
    </a>

    <a href="{% url 'gezana_app:menu_list' %}?category=side"
       class="category-card {% if category == 'side' %}active{% endif %}">
      Side Dish
    </a>

    <a href="{% url 'gezana_app:menu_list' %}?category=dessert"
       class="category-card {% if category == 'dessert' %}active{% endif %}">
      Dessert
    </a>

    <a href="{% url 'gezana_app:menu_list' %}?category=drink"
       class="category-card {% if category == 'drink' %}active{% endif %}">
      Drink
    </a>

  </div>

</section>



{% if recommended and not category and not search %}
<section class="card recommend-wrap">
  <div class="recommend-head">
    <div>
      <p class="eyebrow" style="margin:0;">Top picks</p>
      <h2 style="margin:6px 0 0;">Recommended for you</h2>
      <p class="muted" style="margin:6px 0 0;">Chef’s picks and customer favourites.</p>
    </div>
  </div>

  <div class="recommend-grid">
    {% for r in recommended %}
    <article class="recommend-card">
      <a href="{% url 'gezana_app:menu_detail' r.pk %}" class="recommend-media">
        {% if r.image %}
          <img src="{{ r.image.url }}" alt="{{ r.name }}" loading="lazy">
        {% else %}
          <img src="{% static 'images/no_image_available.png' %}" alt="No image available" loading="lazy">
        {% endif %}

        <div class="recommend-price">€{{ r.price }}</div>

        <div class="recommend-badges">
          {% if r.is_vegetarian %}<span class="pill veg">Veg</span>{% endif %}
          {% if r.is_new %}<span class="pill new">New</span>{% endif %}
          {% if r.is_popular %}<span class="pill popular">Popular</span>{% endif %}
          {% if r.is_chef_choice %}<span class="pill chef">Chef</span>{% endif %}
        </div>
      </a>

      <div class="recommend-body">
        <p class="recommend-cat">{{ r.get_category_display }}</p>
        <h3 class="recommend-title">{{ r.name }}</h3>
        <p class="recommend-desc">{{ r.description }}</p>

        <a class="button primary full" href="{% url 'gezana_app:menu_detail' r.pk %}">
          View dish
        </a>
      </div>
    </article>
    {% endfor %}
  </div>
</section>
{% endif %}

<section class="menu-grid-new">
  {% for item in items %}
    <article class="dish-card">
      <a class="dish-card-media" href="{% url 'gezana_app:menu_detail' item.pk %}">
        {% if item.image %}
          <img src="{{ item.image.url }}" alt="{{ item.name }}" loading="lazy">
        {% else %}
          <img src="{% static 'images/no_image_available.png' %}" alt="No image available" loading="lazy">
        {% endif %}

        <div class="dish-card-badges">
          {% if item.is_vegetarian %}<span class="pill veg">Veg</span>{% endif %}
          {% if item.is_new %}<span class="pill new">New</span>{% endif %}
          {% if item.is_popular %}<span class="pill popular">Popular</span>{% endif %}
          {% if item.is_chef_choice %}<span class="pill chef">Chef</span>{% endif %}
        </div>

        <div class="dish-card-price">€{{ item.price }}</div>
      </a>

      <div class="dish-card-body">
        <p class="dish-card-category">{{ item.get_category_display }}</p>
        <h3 class="dish-card-title">{{ item.name }}</h3>
        <p class="dish-card-desc">{{ item.description }}</p>

        <div class="dish-card-actions">
          <a href="{% url 'gezana_app:menu_detail' item.pk %}" class="button ghost full">
            View details
          </a>
        </div>
      </div>
    </article>
  {% empty %}
    <div class="card">
      <h3 style="margin-top:0;">No dishes found</h3>
      <p class="muted">Try removing filters or searching a different keyword.</p>
      <a class="button ghost" href="{% url 'gezana_app:menu_list' %}">Reset menu</a>
    </div>
  {% endfor %}
</section>

{% endblock %}
