{% extends "gezana_app/base.html" %}
{% block title %}Book a Table{% endblock %}

{% block content %}
<section class="booking-hero">
  <div>
    <p class="eyebrow">Reserve Your Table</p>
    <h2>Book a cozy spot for friends, family, or coffee ceremony</h2>
    <p class="lede">Choose your date and time, and we will find the best table.</p>
  </div>
  <div class="booking-hero-badge">
    <p class="mini">Hours</p>
    <p class="callout">12:00 PM — 7:00 PM</p>
    <p class="note">Walk-ins welcome, but booking is recommended.</p>
  </div>
</section>

{# ✅ Non-field errors show in bold red box #}
{% if form.non_field_errors %}
  <div class="alert alert-error" role="alert">
    {% for error in form.non_field_errors %}
      <p>{{ error }}</p>
    {% endfor %}
  </div>
{% endif %}

<div class="booking-layout">
  <div class="booking-card card">
    <h3>Booking Details</h3>

    <form method="post" novalidate>
      {% csrf_token %}

      <div class="field-block">
        <div class="input-group">
          <i class="fa-solid fa-user"></i>
          {{ form.name }}
        </div>
        {% for e in form.name.errors %}<p class="field-error">{{ e }}</p>{% endfor %}
      </div>

      <div class="field-block">
        <div class="input-group">
          <i class="fa-solid fa-envelope"></i>
          {{ form.email }}
        </div>
        {% for e in form.email.errors %}<p class="field-error">{{ e }}</p>{% endfor %}
        <p class="hint">Provide email or phone (at least one).</p>
      </div>

      <div class="field-block">
        <div class="input-group">
          <i class="fa-solid fa-phone"></i>
          {{ form.phone }}
        </div>
        {% for e in form.phone.errors %}<p class="field-error">{{ e }}</p>{% endfor %}
      </div>

      <div class="field-block">
        <div class="input-group">
          <i class="fa-solid fa-users"></i>
          {{ form.guests }}
        </div>
        {% for e in form.guests.errors %}<p class="field-error">{{ e }}</p>{% endfor %}
      </div>

      <div class="field-block">
        <div class="input-group">
          <i class="fa-solid fa-calendar-days"></i>
          {{ form.date }}
        </div>
        {% for e in form.date.errors %}<p class="field-error">{{ e }}</p>{% endfor %}
        <p class="hint">Past dates are not allowed.</p>
      </div>

      <div class="field-block">
        <div class="input-group">
          <i class="fa-solid fa-clock"></i>
          {{ form.time }}
        </div>
        {% for e in form.time.errors %}<p class="field-error">{{ e }}</p>{% endfor %}
        <p class="hint">Booking hours: 12:00–19:00 (30-minute slots).</p>
      </div>

      <button type="submit" class="button primary full">Confirm Booking</button>
    </form>
  </div>

  <div class="booking-side card">
    <h3>Good to Know</h3>
    <ul class="bullet-list">
      <li>Bookings available 12:00 PM – 7:00 PM.</li>
      <li>We’ll seat you at the best available table for your party size.</li>
      <li>Please call if you’re running late; we hold tables for 15 minutes.</li>
    </ul>

    <div class="divider"></div>

    <h3>Need to cancel?</h3>
    <p>Enter your reference code below or visit the cancel page.</p>
    <form action="{% url 'gezana_app:cancel_booking' %}" method="post" class="inline-cancel-form">
      {% csrf_token %}
      <input type="text" name="reference" placeholder="Enter reference code" required />
      <button type="submit" class="button danger">Cancel booking</button>
      <a class="button ghost" href="{% url 'gezana_app:cancel_booking' %}">Go to cancel page</a>
    </form>
  </div>
</div>
{% endblock %}
